# Vulnerability Scanner Control - Template Specification
#
# This is a template file. Replace all TODO markers with your specific values.
# See CUSTOMIZATION.md for detailed instructions.

# TODO: Generate a new UUID for this control (use: uuidgen)
id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX

# TODO: Short display key (3-6 uppercase letters, shown in UI)
# Examples: SNYK, CKMX (Checkmarx), WIZ, GLAB (GitLab), FORT (Fortify)
displayKey: TODO

# Version number (string format)
version: '1'

# Access roles (empty for official controls)
roles: []

# TODO: Control path (dot notation, matches your directory name)
# Examples: snyk.sast.vulnerabilities, checkmarx.sast.scan, wiz.containers.vulnerabilities
path: tool.scanner.vulnerabilities

# TODO: Short name (shown in lists)
name: Scanner Name

# TODO: Full descriptive name (shown in detail views)
fullName: Tool Name Security Scanning

# TODO: Description of what this control evaluates
# Be specific about:
# - What data source it uses
# - What it checks
# - What policy options are available
description: |
  This control evaluates security scan results from [Tool Name] against
  policy-defined thresholds for vulnerability severity levels.

  The policy allows configuration of:
  - Maximum allowed vulnerabilities per severity level (critical, high, medium, low)
  - Exception lists (CVE/CWE IDs to exclude from evaluation)
  - Location exclusions (file paths/directories to ignore)

  Violations are recorded for each vulnerability that exceeds the configured
  thresholds and is not in the exception list.

# External documentation links (optional)
documentation:
  # TODO: Add relevant documentation URLs
  # - title: Tool Name Documentation
  #   url: https://docs.tool-name.com/
  # - title: SARIF Format Specification
  #   url: https://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html

# Policy structure - customize as needed
measures:
- name: required
  type: metric
  value: bool
  # TODO: Generate new UUID for this measure
  node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
  description: null
  lineItemException:
    enabled: false
    type: null
    expiration:
      required: false
  children: []

- name: vulnerabilities
  type: section
  value: null
  # TODO: Generate new UUID for this section
  node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
  description: null
  lineItemException:
    enabled: false
    type: null
    expiration:
      required: false
  children:
  # Critical severity configuration
  - name: critical
    type: section
    value: null
    # TODO: Generate new UUID
    node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
    description: null
    lineItemException:
      enabled: false
      type: null
      expiration:
        required: false
    children:
    - name: maximum
      type: metric
      value: number
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []
    - name: exceptions
      type: metric
      value: array.string
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []

  # High severity configuration
  - name: high
    type: section
    value: null
    # TODO: Generate new UUID
    node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
    description: null
    lineItemException:
      enabled: false
      type: null
      expiration:
        required: false
    children:
    - name: maximum
      type: metric
      value: number
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []
    - name: exceptions
      type: metric
      value: array.string
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []

  # Medium severity configuration
  - name: medium
    type: section
    value: null
    # TODO: Generate new UUID
    node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
    description: null
    lineItemException:
      enabled: false
      type: null
      expiration:
        required: false
    children:
    - name: maximum
      type: metric
      value: number
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []
    - name: exceptions
      type: metric
      value: array.string
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []

  # Low severity configuration
  - name: low
    type: section
    value: null
    # TODO: Generate new UUID
    node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
    description: null
    lineItemException:
      enabled: false
      type: null
      expiration:
        required: false
    children:
    - name: maximum
      type: metric
      value: number
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []
    - name: exceptions
      type: metric
      value: array.string
      # TODO: Generate new UUID
      node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
      description: null
      lineItemException:
        enabled: false
        type: null
        expiration:
          required: false
      children: []

# File/path exclusions
- name: exclusions
  type: section
  value: null
  # TODO: Generate new UUID
  node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
  description: null
  lineItemException:
    enabled: false
    type: null
    expiration:
      required: false
  children:
  - name: locations
    type: metric
    value: array.string
    # TODO: Generate new UUID
    node_id: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
    description: null
    lineItemException:
      enabled: false
      type: null
      expiration:
        required: false
    children: []

# Supported result states
results:
  fail: true
  inProgress: false
  notFound: true
  notRequired: true
  pass: true
  warn: false

# Evaluation scope
scope: commit

# Retry support
retries: false

# Data source configuration
relations:
- isPrimary: false
  # Standard collection UUID (same for all official controls)
  collection: 6253b179-630e-46d7-9aa8-88c446a14aaf
  # Standard domain UUID (Compliance Controls domain)
  domain: 09c27275-3aaa-4530-bb62-07dc02d3b63c
  subscription:
    # TODO: Update to match your occurrence path
    # This should match where your integration publishes occurrence data
    # Examples:
    #   - security.sast.snyk
    #   - security.sast.checkmarx
    #   - security.containers.wiz
    #   - security.secrets.gitlab
    path: security.scanner.occurrence-path
    integration:
      # Integration type (usually "plugin")
      type: plugin
      # TODO: Update to match your plugin/integration name
      # This should match the name of your data source plugin
      # Examples: snyk-sast, checkmarx, wiz, gitlab-secrets
      path: tool-plugin-name
    # Always "occurrence" for official controls
    note: occurrence

# Asset type targeting
# This configuration allows the control to run on modules, repositories, and artifacts
# with both commit and tag series
assets:
- type: module
  cardinality: all
  # Standard module asset type UUID
  targetAssetTypeUuid: 840b4288-375c-43e3-93d1-b75bef079270
  series:
  - name: commit
    code: 2112
  - name: tag
    code: 2113
- type: repository
  cardinality: all
  # Standard repository asset type UUID
  targetAssetTypeUuid: 681da6ae-edbc-4587-8777-1503602abd4a
  series:
  - name: commit
    code: 2112
  - name: tag
    code: 2113
- type: artifact
  cardinality: all
  # Standard artifact asset type UUID
  targetAssetTypeUuid: a1d9bdc6-a29c-4247-8b1e-c8bd5fea1b55
  series:
  - name: commit
    code: 2112
  - name: tag
    code: 2113

# Official control flags (standardized values)
isOfficial: true
evidenceSubmissions: false
manualAttestations: false
